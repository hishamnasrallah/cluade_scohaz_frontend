<!-- resource-table.component.html -->
<div class="table-container">
    <div class="actions-bar">
        <button mat-raised-button color="primary"
                *ngIf="resource.canCreate"
                (click)="onCreate.emit()">
            <mat-icon>add</mat-icon>
            Add New {{ formatColumnName(resource.name) }}
        </button>
        <button mat-button (click)="onRefresh.emit()">
            <mat-icon>refresh</mat-icon>
            Refresh
        </button>
    </div>

    <div *ngIf="loading" class="loading-data">
        <mat-spinner diameter="30"></mat-spinner>
        <span>Loading data...</span>
    </div>

    <div *ngIf="!loading && data && data.length > 0" class="table-wrapper">
        <table mat-table [dataSource]="data" class="resource-table">
            <!-- Dynamic columns -->
            <ng-container *ngFor="let col of displayColumns" [matColumnDef]="col">
                <th mat-header-cell *matHeaderCellDef class="table-header">
                    {{ formatColumnName(col) }}
                </th>
                <td mat-cell *matCellDef="let element" class="table-cell">
                    <!-- File field -->
                    <span *ngIf="getFieldType(col) === 'FileField' && element[col]" class="file-link">
            <a [href]="element[col]" target="_blank" rel="noopener noreferrer" class="file-url">
              <mat-icon class="file-icon">attachment</mat-icon>
              View File
            </a>
          </span>
                    <span *ngIf="getFieldType(col) === 'FileField' && !element[col]" class="no-file">
            No file
          </span>

                    <!-- Regular fields -->
                    <span *ngIf="getFieldType(col) !== 'FileField' && !isRelation(col)" class="cell-content">
            {{ formatCellValue(element[col]) }}
          </span>

                    <!-- Relation fields -->
                    <span *ngIf="isRelation(col)" class="relation-field">
            {{ element[col] || 'N/A' }}
          </span>
                </td>
            </ng-container>

            <!-- Actions column -->
            <ng-container matColumnDef="actions">
                <th mat-header-cell *matHeaderCellDef class="actions-header">Actions</th>
                <td mat-cell *matCellDef="let element" class="actions-cell">
                    <div class="action-buttons">
                        <button mat-icon-button
                                *ngIf="resource.canRead"
                                (click)="onView.emit(element)"
                                matTooltip="View Details"
                                class="action-btn view-btn">
                            <mat-icon>visibility</mat-icon>
                        </button>
                        <button mat-icon-button
                                *ngIf="resource.canUpdate"
                                (click)="onEdit.emit(element)"
                                matTooltip="Edit"
                                class="action-btn edit-btn">
                            <mat-icon>edit</mat-icon>
                        </button>
                        <button mat-icon-button
                                *ngIf="resource.canDelete"
                                (click)="onDelete.emit(element)"
                                matTooltip="Delete"
                                color="warn"
                                class="action-btn delete-btn">
                            <mat-icon>delete</mat-icon>
                        </button>
                    </div>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="allColumns" class="table-header-row"></tr>
            <tr mat-row *matRowDef="let row; columns: allColumns;" class="table-row"></tr>
        </table>

        <mat-paginator [pageSizeOptions]="[5, 10, 20]"
                       showFirstLastButtons
                       class="table-paginator">
        </mat-paginator>
    </div>

    <div *ngIf="!loading && (!data || data.length === 0)" class="no-data">
        <mat-icon class="no-data-icon">inbox</mat-icon>
        <p class="no-data-text">No {{ resource.name }} records found</p>
        <button mat-raised-button color="primary"
                *ngIf="resource.canCreate"
                (click)="onCreate.emit()"
                class="create-first-btn">
            Create First {{ formatColumnName(resource.name) }}
        </button>
    </div>
</div>
